<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Magic Travel - Cadastro de Vendas</title>

  <!-- ========== CSS do Template (PlainAdmin) ========== -->
  <!-- Ajuste se necessário o caminho dos arquivos CSS -->
  <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
  <link rel="stylesheet" href="assets/css/lineicons.css" />
  <link rel="stylesheet" href="assets/css/quill/bubble.css" />
  <link rel="stylesheet" href="assets/css/quill/snow.css" />
  <link rel="stylesheet" href="assets/css/fullcalendar.css" />
  <link rel="stylesheet" href="assets/css/morris.css" />
  <link rel="stylesheet" href="assets/css/datatable.css" />
  <link rel="stylesheet" href="assets/css/main.css" />

  <!-- ========== Estilos Extras Para o Formulário da Magic Travel ========== -->
  <style>
    .form-container {
      background: #ffffff;
      padding: 20px;
      border-radius: 6px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    .form-container h1 {
      margin-bottom: 20px;
      font-size: 1.5rem;
    }
    .form-container h2 {
      margin-top: 20px;
      margin-bottom: 15px;
      font-size: 1.2rem;
      border-bottom: 1px solid #ccc;
      padding-bottom: 5px;
    }
    .form-group {
      margin-bottom: 15px;
    }
    label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
    }
    input[type="text"],
    input[type="tel"],
    input[type="email"],
    input[type="date"],
    input[type="number"],
    select,
    textarea {
      width: 100%;
      padding: 6px 10px;
      box-sizing: border-box;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    textarea {
      resize: vertical;
    }
    .row {
      display: flex;
      flex-wrap: wrap;
      margin-bottom: 5px;
    }
    .col-50 {
      width: 50%;
      padding-right: 10px;
      box-sizing: border-box;
    }
    .col-33 {
      width: 33.3333%;
      padding-right: 10px;
      box-sizing: border-box;
    }
    .col-25 {
      width: 25%;
      padding-right: 10px;
      box-sizing: border-box;
    }
    .col-100 {
      width: 100%;
      padding-right: 0;
      box-sizing: border-box;
    }
    .row > .col-50:last-child,
    .row > .col-33:last-child,
    .row > .col-25:last-child {
      padding-right: 0;
    }
    .btn {
      background-color: #3a86ff;
      color: #fff;
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.95rem;
      transition: background-color 0.2s ease-in-out;
      margin-top: 10px;
    }
    .btn:hover {
      background-color: #2a5fb2;
    }
    @media (max-width: 768px) {
      .col-50,
      .col-33,
      .col-25 {
        width: 100%;
        padding-right: 0;
      }
    }
  </style>
</head>

<body>
  <!-- ======== Preloader (padrão do template) =========== -->
  <div id="preloader">
    <div class="spinner"></div>
  </div>
  <!-- ======== Preloader =========== -->

  <!-- ======== sidebar-nav start (padrão do template) =========== -->
  <aside class="sidebar-nav-wrapper">
    <div class="navbar-logo">
      <a href="index.html">
        <img src="assets/images/logo/logo.svg" alt="logo" />
      </a>
    </div>
    <nav class="sidebar-nav">
      <ul>
        <li class="nav-item nav-item-has-children">
          <a href="#0" class="collapsed" data-bs-toggle="collapse" data-bs-target="#ddmenu_1" aria-controls="ddmenu_1"
            aria-expanded="false" aria-label="Toggle navigation">
            <span class="icon">
              <!-- Ícone de exemplo do Dashboard -->
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                <path d="M8.74999 18.3333C12.2376 18.3333 15.1364 15.8128 15.7244 12.4941C15.8448 11.8143 15.2737 11.25 14.5833 11.25H9.99999C9.30966 11.25 8.74999 10.6903 8.74999 10V5.41666C8.74999 4.7263 8.18563 4.15512 7.50586 4.27556C4.18711 4.86357 1.66666 7.76243 1.66666 11.25C1.66666 15.162 4.83797 18.3333 8.74999 18.3333Z" />
                <path d="M17.0833 10C17.7737 10 18.3432 9.43708 18.2408 8.75433C17.7005 5.14918 14.8508 2.29947 11.2457 1.75912C10.5629 1.6568 10 2.2263 10 2.91665V9.16666C10 9.62691 10.3731 10 10.8333 10H17.0833Z" />
              </svg>
            </span>
            <span class="text">Dashboard</span>
          </a>
          <ul id="ddmenu_1" class="collapse dropdown-nav">
            <li><a href="index.html"> eCommerce </a></li>
            <li><a href="analytics-dashboard.html"> Analytics </a></li>
            <li><a href="crypto.html"> Crypto </a></li>
            <li><a href="crm-dashboard.html"> CRM </a></li>
            <li><a href="marketing-dashboard.html"> Marketing </a></li>
          </ul>
        </li>
        <!-- ... Mais itens do menu lateral ... -->
      </ul>
    </nav>
    <div class="promo-box">
      <div class="promo-icon">
        <img class="mx-auto" src="assets/images/logo/logo-icon-big.svg" alt="Logo">
      </div>
      <h3>Upgrade to PRO</h3>
      <p>Improve your development process and start doing more with PlainAdmin PRO!</p>
      <a href="https://plainadmin.com/pro" target="_blank" rel="nofollow" class="main-btn primary-btn btn-hover">
        Upgrade to PRO
      </a>
    </div>
  </aside>
  <div class="overlay"></div>
  <!-- ======== sidebar-nav end =========== -->

  <!-- ======== main-wrapper start (onde vai ficar nosso formulário) =========== -->
  <main class="main-wrapper">
    <!-- ========== header start ========== -->
    <header class="header">
      <div class="container-fluid">
        <div class="row">
          <div class="col-lg-5 col-md-5 col-6">
            <div class="header-left d-flex align-items-center">
              <div class="menu-toggle-btn mr-15">
                <button id="menu-toggle" class="main-btn primary-btn btn-hover">
                  <i class="lni lni-chevron-left me-2"></i> Menu
                </button>
              </div>
              <div class="header-search d-none d-md-flex">
                <form action="#">
                  <input type="text" placeholder="Search..." />
                  <button><i class="lni lni-search-alt"></i></button>
                </form>
              </div>
            </div>
          </div>
          <div class="col-lg-7 col-md-7 col-6">
            <div class="header-right">
              <!-- Notificações, mensagens e perfil do template. Você pode remover se desejar -->
              <div class="notification-box ml-15 d-none d-md-flex">
                <button class="dropdown-toggle" type="button" id="notification" data-bs-toggle="dropdown"
                  aria-expanded="false">
                  <svg width="22" height="22" viewBox="0 0 22 22" fill="none">
                    <path d="M11 20.1667C9.88317 20.1667 8.88718 19.63 8.23901 18.7917H13.761C13.113 19.63 12.1169 20.1667 11 20.1667Z"/>
                    <path d="M10.1157 2.74999C10.1157 2.24374 10.5117 1.83333 11 1.83333C11.4883 1.83333 11.8842 2.24374 11.8842 2.74999V2.82604C14.3932 3.26245 16.3051 5.52474 16.3051 8.24999V14.287C16.3051 14.5301 16.3982 14.7633 16.564 14.9352L18.2029 16.6342C18.4814 16.9229 18.2842 17.4167 17.8903 17.4167H4.10961C3.71574 17.4167 3.5185 16.9229 3.797 16.6342L5.43589 14.9352C5.6017 14.7633 5.69485 14.5301 5.69485 14.287V8.24999C5.69485 5.52474 7.60672 3.26245 10.1157 2.82604V2.74999Z"/>
                    <path d="M7.48901 17.1925C8.10004 17.8918 8.99841 18.3335 10 18.3335C11.0016 18.3335 11.9 17.8918 12.511 17.1925C10.8482 17.4634 9.15183 17.4634 7.48901 17.1925Z"/>
                  </svg>
                  <span></span>
                </button>
                <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="notification">
                  <li>
                    <a href="#0">
                      <div class="image">
                        <img src="assets/images/lead/lead-6.png" alt="" />
                      </div>
                      <div class="content">
                        <h6>John Doe <span class="text-regular">comment on a product.</span></h6>
                        <p>Lorem ipsum dolor sit amet.</p>
                        <span>10 mins ago</span>
                      </div>
                    </a>
                  </li>
                  <li>
                    <a href="#0">
                      <div class="image">
                        <img src="assets/images/lead/lead-1.png" alt="" />
                      </div>
                      <div class="content">
                        <h6>Jonathon <span class="text-regular">like on a product.</span></h6>
                        <p>Lorem ipsum dolor sit amet.</p>
                        <span>10 mins ago</span>
                      </div>
                    </a>
                  </li>
                </ul>
              </div>
              <div class="header-message-box ml-15 d-none d-md-flex">
                <button class="dropdown-toggle" type="button" id="message" data-bs-toggle="dropdown" aria-expanded="false">
                  <svg width="22" height="22" viewBox="0 0 22 22" fill="none">
                    <path d="M7.74866 5.97421C7.91444 5.96367 8.08162 5.95833 8.25005 5.95833C12.5532 5.95833 16.0417 9.4468 16.0417 13.75C16.0417 13.9184 16.0364 14.0856 16.0259 14.2514C16.3246 14.138 16.6127 14.003 16.8883 13.8482L19.2306 14.629C19.7858 14.8141 20.3141 14.2858 20.129 13.7306L19.3482 11.3882C19.8694 10.4604 20.1667 9.38996 20.1667 8.25C20.1667 4.70617 17.2939 1.83333 13.75 1.83333C11.0077 1.83333 8.66702 3.55376 7.74866 5.97421Z"/>
                    <path d="M14.6667 13.75C14.6667 17.2938 11.7939 20.1667 8.25004 20.1667C7.11011 20.1667 6.03962 19.8694 5.11182 19.3482L2.76946 20.129C2.21421 20.3141 1.68597 19.7858 1.87105 19.2306L2.65184 16.8882C2.13062 15.9604 1.83338 14.89 1.83338 13.75C1.83338 10.2062 4.70622 7.33333 8.25004 7.33333C11.7939 7.33333 14.6667 10.2062 14.6667 13.75ZM5.95838 13.75C5.95838 13.2437 5.54797 12.8333 5.04171 12.8333C4.53545 12.8333 4.12504 13.2437 4.12504 13.75C4.12504 14.2563 4.53545 14.6667 5.04171 14.6667C5.54797 14.6667 5.95838 14.2563 5.95838 13.75ZM9.16671 13.75C9.16671 13.2437 8.7563 12.8333 8.25004 12.8333C7.74379 12.8333 7.33338 13.2437 7.33338 13.75C7.33338 14.2563 7.74379 14.6667 8.25004 14.6667C8.7563 14.6667 9.16671 14.2563 9.16671 13.75ZM11.4584 14.6667C11.9647 14.6667 12.375 14.2563 12.375 13.75C12.375 13.2437 11.9647 12.8333 11.4584 12.8333C10.9521 12.8333 10.5417 13.2437 10.5417 13.75C10.5417 14.2563 10.9521 14.6667 11.4584 14.6667Z"/>
                  </svg>
                  <span></span>
                </button>
                <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="message">
                  <li>
                    <a href="#0">
                      <div class="image">
                        <img src="assets/images/lead/lead-5.png" alt="" />
                      </div>
                      <div class="content">
                        <h6>Jacob Jones</h6>
                        <p>Hey!I can across your profile...</p>
                        <span>10 mins ago</span>
                      </div>
                    </a>
                  </li>
                  <li>
                    <a href="#0">
                      <div class="image">
                        <img src="assets/images/lead/lead-3.png" alt="" />
                      </div>
                      <div class="content">
                        <h6>John Doe</h6>
                        <p>Would you mind please checking out</p>
                        <span>12 mins ago</span>
                      </div>
                    </a>
                  </li>
                  <li>
                    <a href="#0">
                      <div class="image">
                        <img src="assets/images/lead/lead-2.png" alt="" />
                      </div>
                      <div class="content">
                        <h6>Anee Lee</h6>
                        <p>Hey! are you available for freelance?</p>
                        <span>1h ago</span>
                      </div>
                    </a>
                  </li>
                </ul>
              </div>
              <div class="profile-box ml-15">
                <button class="dropdown-toggle bg-transparent border-0" type="button" id="profile" data-bs-toggle="dropdown"
                  aria-expanded="false">
                  <div class="profile-info">
                    <div class="info">
                      <div class="image">
                        <img src="assets/images/profile/profile-image.png" alt="" />
                      </div>
                      <div>
                        <h6 class="fw-500">Adam Joe</h6>
                        <p>Admin</p>
                      </div>
                    </div>
                  </div>
                </button>
                <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="profile">
                  <li>
                    <div class="author-info flex items-center !p-1">
                      <div class="image">
                        <img src="assets/images/profile/profile-image.png" alt="image">
                      </div>
                      <div class="content">
                        <h4 class="text-sm">Adam Joe</h4>
                        <a class="text-black/40 dark:text-white/40 hover:text-black dark:hover:text-white text-xs" href="#">
                          Email@gmail.com
                        </a>
                      </div>
                    </div>
                  </li>
                  <li class="divider"></li>
                  <li><a href="#0"><i class="lni lni-user"></i>View Profile</a></li>
                  <li><a href="#0"><i class="lni lni-alarm"></i>Notifications</a></li>
                  <li><a href="#0"><i class="lni lni-inbox"></i>Messages</a></li>
                  <li><a href="#0"><i class="lni lni-cog"></i>Settings</a></li>
                  <li class="divider"></li>
                  <li><a href="#0"><i class="lni lni-exit"></i>Sign Out</a></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </header>
    <!-- ========== header end ========== -->

    <!-- ========== SEÇÃO PRINCIPAL ONDE INSERIMOS O FORMULÁRIO MAGIC TRAVEL ========== -->
    <section class="tab-components pt-30">
      <div class="container-fluid">
        <div class="form-layout-wrapper">
          <div class="row">
            <div class="col-12">
              <div class="card-style mb-30">
                <!-- Formulário de Cadastro de Vendas -->
                <div class="form-container">
                  <h1>Cadastro de Vendas</h1>
                  <form id="salesForm">
                    <!-- Seção: Informações Gerais -->
                    <section>
                      <h2>Informações Gerais</h2>
                      <div class="row">
                        <div class="form-group col-50">
                          <label for="data_venda">Data da Venda:</label>
                          <input type="date" id="data_venda" name="data_venda" required>
                        </div>
                        <div class="form-group col-50">
                          <label for="nome">Nome do Passageiro:</label>
                          <input type="text" id="nome" name="nome" placeholder="Nome do Passageiro" required>
                        </div>
                      </div>
                      <div class="row">
                        <div class="form-group col-50">
                          <label for="email">E-mail:</label>
                          <input type="email" id="email" name="email" placeholder="E-mail" required>
                        </div>
                        <div class="form-group col-50">
                          <label for="telefone">Telefone:</label>
                          <input type="tel" id="telefone" name="telefone" placeholder="Telefone" required>
                        </div>
                      </div>
                      <div class="row">
                        <div class="form-group col-50">
                          <label for="data_nascimento">Data de Nascimento:</label>
                          <input type="date" id="data_nascimento" name="data_nascimento" required>
                        </div>
                        <div class="form-group col-50">
                          <label for="cpf">CPF:</label>
                          <input type="text" id="cpf" name="cpf" placeholder="CPF" required>
                        </div>
                      </div>
                    </section>

                    <!-- Seção: Emissão -->
                    <section>
                      <h2>Emissão</h2>
                      <div class="row">
                        <div class="form-group col-50">
                          <label for="data_utilizacao">Data de Utilização:</label>
                          <input type="date" id="data_utilizacao" name="data_utilizacao" required>
                        </div>
                        <div class="form-group col-50">
                          <label for="destino">Destino:</label>
                          <input type="text" id="destino" name="destino" required>
                        </div>
                      </div>
                      <div class="form-group col-100">
                        <label for="item">Categoria:</label>
                        <select id="item" name="item" required>
                          <option value="">Selecione</option>
                          <option value="Ingressos">Ingressos</option>
                          <option value="Hospedagem">Hospedagem</option>
                          <option value="Aluguel de Carro">Aluguel de Carro</option>
                          <option value="Passagem Aérea">Passagem Aérea</option>
                          <option value="Cruzeiro">Cruzeiro</option>
                          <option value="Guiamento Remoto">Guiamento Remoto</option>
                          <option value="Seguro Viagem">Seguro Viagem</option>
                        </select>
                      </div>
                    </section>

                    <!-- Seção: Financeiro -->
                    <section>
                      <h2>Financeiro</h2>
                      <div class="row">
                        <div class="form-group col-33">
                          <label for="nome_comprador">Nome do Pagador:</label>
                          <input type="text" id="nome_comprador" name="nome_comprador" required>
                        </div>
                        <div class="form-group col-33">
                          <label for="gateway">Gateway:</label>
                          <select id="gateway" name="gateway" required>
                            <option value="ValePay">ValePay</option>
                            <option value="PagBank">PagBank</option>
                            <option value="PayPal">PayPal</option>
                            <option value="Pix Direto">Pix Direto</option>
                          </select>
                        </div>
                        <div class="form-group col-33">
                          <label for="meio_pgto">Meio de Pagamento:</label>
                          <select id="meio_pgto" name="meio_pgto" required>
                            <option value="Pix">Pix</option>
                            <option value="Cartão">Cartão</option>
                            <option value="Boleto">Boleto</option>
                            <option value="Split">Split</option>
                          </select>
                        </div>
                      </div>
                      <div class="row">
                        <div class="form-group col-25">
                          <label for="bandeira_cartao">Bandeira do Cartão:</label>
                          <input type="text" id="bandeira_cartao" name="bandeira_cartao">
                        </div>
                        <div class="form-group col-25">
                          <label for="parcelas">Parcelas:</label>
                          <input type="number" id="parcelas" name="parcelas" min="1" max="12">
                        </div>
                        <div class="form-group col-25">
                          <label for="valor_venda">Valor da Venda:</label>
                          <input type="number" id="valor_venda" name="valor_venda" step="0.01" required>
                        </div>
                        <div class="form-group col-25">
                          <label for="valor_repassado">Valor Repassado:</label>
                          <input type="number" id="valor_repassado" name="valor_repassado" step="0.01" required>
                        </div>
                      </div>
                    </section>

                    <!-- Seção: Comercial -->
                    <section>
                      <h2>Comercial</h2>
                      <div class="row">
                        <div class="form-group col-50">
                          <label for="origem_cliente">Origem do Cliente:</label>
                          <select id="origem_cliente" name="origem_cliente">
                            <option value="Indicação">Indicação</option>
                            <option value="Blog">Blog</option>
                            <option value="Site">Site</option>
                            <option value="Anúncio">Anúncio</option>
                            <option value="Direct do Instagram">Direct do Instagram</option>
                          </select>
                        </div>
                        <div class="form-group col-50">
                          <label for="cliente_de">Cliente Atendido Por:</label>
                          <select id="cliente_de" name="cliente_de" required>
                            <option value="">Selecione</option>
                            <option value="Matheus Alvarenga">Matheus Alvarenga</option>
                            <option value="Raphaela Raposo">Raphaela Raposo</option>
                            <option value="Vanessa Barreto">Vanessa Barreto</option>
                            <option value="Breno Severiano">Breno Severiano</option>
                            <option value="Mariane Nunes">Mariane Nunes</option>
                            <option value="Guilherme Raimundi">Guilherme Raimundi</option>
                          </select>
                        </div>
                      </div>
                      <div class="row">
                        <div class="form-group col-50">
                          <label for="efetivado_por">Venda Finalizada Por:</label>
                          <select id="efetivado_por" name="efetivado_por" required>
                            <option value="">Selecione</option>
                            <option value="Matheus Alvarenga">Matheus Alvarenga</option>
                            <option value="Raphaela Raposo">Raphaela Raposo</option>
                            <option value="Vanessa Barreto">Vanessa Barreto</option>
                            <option value="Breno Severiano">Breno Severiano</option>
                            <option value="Mariane Nunes">Mariane Nunes</option>
                            <option value="Guilherme Raimundi">Guilherme Raimundi</option>
                          </select>
                        </div>
                      </div>
                      <div class="row">
                        <div class="form-group col-100">
                          <label for="observacoes_operacionais">Observações Operacionais:</label>
                          <textarea id="observacoes_operacionais" name="observacoes_operacionais" rows="3" placeholder="Digite suas observações operacionais"></textarea>
                        </div>
                      </div>
                      <div class="row">
                        <div class="form-group col-100">
                          <label for="observacoes_financeiras">Observações Financeiras:</label>
                          <textarea id="observacoes_financeiras" name="observacoes_financeiras" rows="3" placeholder="Digite suas observações financeiras"></textarea>
                        </div>
                      </div>
                    </section>

                    <!-- Campos Ocultos -->
                    <input type="hidden" id="id" name="id">
                    <input type="hidden" id="mes_venda" name="mes_venda">
                    <input type="hidden" id="uf" name="uf">
                    <input type="hidden" id="valor_comissao" name="valor_comissao">
                    <input type="hidden" id="markup" name="markup">
                    <input type="hidden" id="comissao_do_agente" name="comissao_do_agente">
                    <input type="hidden" id="data_pgto" name="data_pgto">
                    <input type="hidden" id="recebido" name="recebido">
                    <input type="hidden" id="data_repasse" name="data_repasse">

                    <button id="submitButton" type="button" class="btn">Salvar</button>
                  </form>
                </div>
              </div>
              <!-- end card-style -->
            </div>
            <!-- end col-12 -->
          </div>
          <!-- end row -->
        </div>
      </div>
    </section>

    <!-- ========== footer start (padrão do template) ========== -->
    <footer class="footer">
      <div class="container-fluid">
        <div class="row">
          <div class="col-md-6 order-last order-md-first">
            <div class="copyright text-center text-md-start">
              <p class="text-sm">
                Designed and Developed by
                <a href="https://plainadmin.com" rel="nofollow" target="_blank">PlainAdmin</a>
              </p>
            </div>
          </div>
          <div class="col-md-6">
            <div class="terms d-flex justify-content-center justify-content-md-end">
              <a href="#0" class="text-sm">Term & Conditions</a>
              <a href="#0" class="text-sm ml-15">Privacy & Policy</a>
            </div>
          </div>
        </div>
      </div>
    </footer>
    <!-- ========== footer end ========== -->
  </main>
  <!-- ======== main-wrapper end =========== -->

  <!-- ============ Theme Option Start (opcional do template) ============= -->
  <button class="option-btn"><i class="lni lni-cog"></i></button>
  <div class="option-overlay"></div>
  <div class="option-box">
    <div class="option-header">
      <h5>Settings</h5>
      <button class="option-btn-close text-gray"><i class="lni lni-close"></i></button>
    </div>
    <h6 class="mb-10">Layout</h6>
    <ul class="mb-30">
      <li><button class="leftSidebarButton active">Left Sidebar</button></li>
      <li><button class="rightSidebarButton">Right Sidebar</button></li>
    </ul>
    <h6 class="mb-10">Theme</h6>
    <ul class="d-flex flex-wrap align-items-center">
      <li><button class="lightThemeButton active">Light Theme + Sidebar 1</button></li>
      <li><button class="darkThemeButton">Dark Theme + Sidebar 1</button></li>
    </ul>
  </div>
  <!-- ============ Theme Option End ============= -->

  <!-- ========= Scripts do Template (PlainAdmin) ======== -->
  <script src="assets/js/bootstrap.bundle.min.js"></script>
  <script src="assets/js/Chart.min.js"></script>
  <script src="assets/js/apexcharts.min.js"></script>
  <script src="assets/js/dynamic-pie-chart.js"></script>
  <script src="assets/js/moment.min.js"></script>
  <script src="assets/js/fullcalendar.js"></script>
  <script src="assets/js/jvectormap.min.js"></script>
  <script src="assets/js/world-merc.js"></script>
  <script src="assets/js/polyfill.js"></script>
  <script src="assets/js/quill.min.js"></script>
  <script src="assets/js/datatable.js"></script>
  <script src="assets/js/Sortable.min.js"></script>
  <script src="assets/js/main.js"></script>

  <!-- ========== Script do Preloader e do Formulário Magic Travel ========== -->
  <script>
    // 1) Esconder o preloader quando a janela terminar de carregar
    window.addEventListener('load', function() {
      const preloader = document.getElementById('preloader');
      if(preloader){
        preloader.style.display = 'none';
      }
    });

    // 2) Aguardar DOM carregado para tratar o resto do script
    document.addEventListener('DOMContentLoaded', function() {

      // Exemplo de uso do menu-toggle para evitar erro
      const menuToggleBtn = document.querySelector('#menu-toggle');
      if (menuToggleBtn) {
        menuToggleBtn.addEventListener('click', function() {
          // Ação de abrir/fechar sidebar ou o que preferir
          document.querySelector('.sidebar-nav-wrapper').classList.toggle('show');
        });
      }

      // Gerar ID automaticamente ao carregar a página (se necessário)
      const idField = document.getElementById('id');
      if (idField) {
        // Se esta URL não existir ou der erro, seu código não vai travar; apenas cairá no catch
        fetch('https://airland.com.br/get_next_id.php')
          .then(response => response.json())
          .then(data => {
            idField.value = data.next_id || 2501; // Valor padrão 2501 se não retornar nada
          })
          .catch(err => {
            console.error('Erro ao buscar próximo ID:', err);
            // Fallback
            idField.value = 2501;
          });
      }

      // Preencher Mês da Venda e Data de Pagamento com base na Data da Venda
      const dataVendaField = document.getElementById('data_venda');
      const mesVendaField = document.getElementById('mes_venda');
      const dataPgtoField = document.getElementById('data_pgto');
      if (dataVendaField && mesVendaField && dataPgtoField) {
        dataVendaField.addEventListener('change', function () {
          const dataVenda = new Date(this.value);
          if (!isNaN(dataVenda.getTime())) {
            const mesVenda = dataVenda.toLocaleString('default', { month: 'long' });
            mesVendaField.value = mesVenda;
            dataPgtoField.value = this.value;
          }
        });
      }

      // Preencher UF automaticamente com base no DDD do Telefone
      const telefoneField = document.getElementById('telefone');
      const ufField = document.getElementById('uf');
      if (telefoneField && ufField) {
        telefoneField.addEventListener('blur', function () {
          const ddd = this.value.replace(/\D/g, '').slice(0, 2);
          const estados = {
            '91': 'PA', '92': 'AM', '93': 'PA', '94': 'PA', '95': 'RR', '96': 'AP', '97': 'AM',
            '98': 'MA', '99': 'MA', '71': 'BA', '73': 'BA', '74': 'BA', '75': 'BA', '77': 'BA',
            '81': 'PE', '82': 'AL', '83': 'PB', '84': 'RN', '85': 'CE', '86': 'PI', '87': 'PE',
            '88': 'CE', '89': 'PI', '61': 'DF', '62': 'GO', '63': 'TO', '64': 'GO', '65': 'MT',
            '66': 'MT', '67': 'MS', '11': 'SP', '12': 'SP', '13': 'SP', '14': 'SP', '15': 'SP',
            '16': 'SP', '17': 'SP', '18': 'SP', '19': 'SP', '21': 'RJ', '22': 'RJ', '24': 'RJ',
            '27': 'ES', '28': 'ES', '31': 'MG', '32': 'MG', '33': 'MG', '34': 'MG', '35': 'MG',
            '37': 'MG', '38': 'MG', '41': 'PR', '42': 'PR', '43': 'PR', '44': 'PR', '45': 'PR',
            '46': 'PR', '47': 'SC', '48': 'SC', '49': 'SC', '51': 'RS', '53': 'RS', '54': 'RS',
            '55': 'RS'
          };
          ufField.value = estados[ddd] || '';
        });
      }

      // Botão de Salvar
      const submitButton = document.getElementById('submitButton');
      if (submitButton) {
        submitButton.addEventListener('click', function () {

          const valorVenda = parseFloat(document.getElementById('valor_venda')?.value) || 0;
          const valorRepassado = parseFloat(document.getElementById('valor_repassado')?.value) || 0;
          
          // receitaAgencia = valorRepassado (se custo for zero)
          const valorComissaoField = document.getElementById('valor_comissao');
          const receitaAgencia = valorRepassado;
          if (valorComissaoField) {
            valorComissaoField.value = receitaAgencia.toFixed(2);
          }
          
          // Markup (exemplo de cálculo)
          const markupField = document.getElementById('markup');
          if (markupField) {
            const markup = valorRepassado > 0 ? (receitaAgencia / valorRepassado) * 100 : 0;
            markupField.value = markup.toFixed(2);
          }

          // Determinar Comissão do Agente com base na categoria
          const categoria = document.getElementById('item')?.value || "";
          const comissaoDoAgenteField = document.getElementById('comissao_do_agente');
          const comissoes = {
            "Ingressos": 0.003,
            "Hospedagem": 0.003,
            "Passagem Aérea": 0.01,
            "Seguro Viagem": 0.1,
            "Guiamento Remoto": 0.12,
            "Aluguel de Carro": 0.01,
            "Cruzeiro": 0.01
          };
          const comissaoDoAgente = valorRepassado * (comissoes[categoria] || 0);
          if (comissaoDoAgenteField) {
            comissaoDoAgenteField.value = comissaoDoAgente.toFixed(2);
          }

          // Preencher Data de Repasse com base no Meio de Pagamento (exemplo simples)
          const dataVendaVal = document.getElementById('data_venda')?.value;
          const meioPagamento = document.getElementById('meio_pgto')?.value || "";
          const dataRepasseField = document.getElementById('data_repasse');

          if (dataVendaVal && dataRepasseField) {
            const dataVendaObj = new Date(dataVendaVal);
            if (!isNaN(dataVendaObj.getTime())) {
              const dataRepasse = new Date(dataVendaObj);
              if (meioPagamento === 'Pix') {
                // Repasse imediato
                dataRepasse.setDate(dataRepasse.getDate());
              } else if (meioPagamento === 'Cartão') {
                // Exemplo: repasse em 2 dias
                dataRepasse.setDate(dataRepasse.getDate() + 2);
              }
              // Ajusta para o formato AAAA-MM-DD
              const isoDate = dataRepasse.toISOString().split('T')[0];
              dataRepasseField.value = isoDate;
            }
          }

          // Preparar dados para envio via fetch
          const form = document.getElementById('salesForm');
          if (form) {
            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());
            
            // Ajuste a URL de envio se necessário
            fetch('https://airland.com.br/process_form.php', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify(data)
            })
            .then(response => {
              if (!response.ok) {
                return response.json().then(err => {
                  console.error('Erro no servidor:', err);
                  alert(`Erro no servidor: ${err.error || 'Erro desconhecido'}`);
                  throw new Error(err.error || 'Erro desconhecido');
                });
              }
              return response.json();
            })
            .then(result => {
              if (result.success) {
                alert('Dados salvos com sucesso!');
                // Recarrega a página para limpar
                window.location.reload(true);
              } else {
                alert(result.error || 'Erro ao salvar os dados.');
              }
            })
            .catch(error => {
              alert('Erro ao processar os dados: ' + error.message);
            });
          }
        });
      }
    });
  </script>
</body>
</html>
